(()=>{const a=(c,d)=>{c.value=d,c.dispatchEvent(new Event('input'))},b=(c,d,f)=>{let g=[];return c.lowEnd.forEach((h,l)=>{if('string'==typeof h)g[l]=h;else{let m=h+(c.topEnd[l]-h)*((d-c.lowStop)/(c.topStop-c.lowStop));g[l]=f?m.toFixed(f):m}}),g.join('')};document.querySelectorAll('.darth-fader').forEach(c=>{c.vals={},c.hiddenInputs={};let d=c.dataset.fades?JSON.parse(c.dataset.fades):{levels:['-100',0,'100',1],colors:['rgb(238,170,0)',0,'rgb(255,255,255)',0.5,'rgb(200, 0, 200)',1]};for(let f in d){for(let h=0,l=d[f].length;h<l;h+=2)d[f][h]=d[f][h].split(/(-?\d*\.{0,1}\d+)/),d[f][h].forEach((m,n)=>{d[f][h][n]=isNaN(parseFloat(m))?m:+m});let g=document.createElement('input');g.type='hidden',g.id=g.name=`${c.id}_${f}`,c.hiddenInputs[f]=g,c.appendChild(g)}if(c.type='range',c.min=0,c.max=1,c.step=1e-3,c.fix=c.dataset.fix?JSON.parse(c.dataset.fix):null,c.dataset.snap&&d[c.dataset.snap]){let f=d[c.dataset.snap],g=document.createElement('datalist');for(let m,h=0,l=f.length;h<l;h+=2)m=document.createElement('option'),m.value=f[h+1],g.appendChild(m);c.appendChild(g),g.id=`${c.id}_datalist`,c.setAttribute('list',g.id)}c.dataset.thumb&&c.addEventListener('valsChanged',()=>{c.style.setProperty('--thumb-color',c.vals[c.dataset.thumb])}),c.value=c.dataset.value?parseFloat(c.dataset.value):0.5,c.setValue=f=>a(c,f),c.addEventListener('input',()=>{let g=parseFloat(c.value);for(let h in d){let l=d[h],m=0;for(;l[1+2*m]<=g&&1!=l[1+2*m];)l.lowStop=l[1+2*m],l.lowEnd=l[2*m],m++;l.topStop=l[1+2*m],l.topEnd=l[2*m],c.vals[h]=c.hiddenInputs[h].value=b(l,g,c.fix)}c.dispatchEvent(new CustomEvent('valsChanged'))}),c.dispatchEvent(new Event('input'))})})();